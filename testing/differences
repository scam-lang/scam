OLD vs. NEW
common.s
------------------------------------------
1c1
< var z-common = { var count = 0; this; };
---
> (include "inherit.lib");
3,8c3
< function z()
<     {
<     var common = z-common;
<     var uncommon = { var count = 0; this;};
<     this;
<     }
---
> (define z-common (scope (define count 0) this))
10,17c5,10
< function x()
<     {
<     proxy(z());
<     ppObject(this);
<     common . count = common . count + 1;
<     uncommon . count = uncommon . count + 1;
<     this;
<     }
---
> (define (z)
>     (define parent nil)
>     (define common z-common)
>     (define uncommon (scope (define count 0) this))
>     this
>     )
19,25c12,17
< function y()
<     {
<     proxy(z());
<     common . count = common . count + 1;
<     uncommon . count = uncommon . count + 1;
<     this;
<     }
---
> (define (x)
>     (define parent (z))
>     (assign (. (. parent common) count) (+ (. (. parent common) count) 1))
>     (assign (. (. parent uncommon) count) (+ (. (. parent uncommon) count) 1))
>     this
>     )
27,29c19,27
< var xish = x();
< var yish = y();
< var zish = z();
---
> (define (y)
>     (define parent (z))
>     (assign (. (. parent common) count) (+ (. (. parent common) count) 1))
>     (assign (. (. parent uncommon) count) (+ (. (. parent uncommon) count) 1))
>     this
>     )
> (define xish (new (x)))
> (define yish (new (y)))
> (define zish (new (z)))
31,34c29,32
< println("x's common count is ", xish . common . count);
< println("y's common count is ", yish . common . count);
< println("x's uncommon count is ", xish . uncommon . count);
< println("y's uncommon count is ", yish . uncommon . count);
---
> (println "x's common count is " (. (. xish common) count))
> (println "y's common count is " (. (. yish common) count))
> (println "x's uncommon count is " (. (. xish uncommon) count))
> (println "y's uncommon count is " (. (. yish uncommon) count))
36,44d33
< <OBJECT 3300>:
<     context: <OBJECT 966>
<     dynamicContext: <OBJECT 966>
<     callDepth: 1
<     constructor: <function x()>
<     this: <OBJECT 3300>
<     constructor: <function z()>
<     uncommon: <OBJECT 3338>
<     common: <OBJECT 3221>
------------------------------------------
