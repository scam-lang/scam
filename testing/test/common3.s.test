(include "inherit.lib")

(define (+= # $v value)
    (set $v (+ (eval $v #) value) #)
    )

(define common 0)

(define (z)
    (define parent nil)
    (define uncommon 0)
    (+= common 1)
    (+= uncommon 1)
    this
    )

(define (x)
    (define parent (z))
    this
    )

(inspect (get 'common (new (x))))
(inspect (get 'common (new (x))))
(inspect (get 'uncommon (new (x))))
(inspect (get 'uncommon (new (x))))
------------------------------------------
(get (quote common) (new (x))) is <object 18312>
             __label  : throw
                code  : undefinedVariable
               value  : "file inherit.lib,line 31: variable . is undefined"
               trace  : ((get (quote common) (new (x))) (set (quote __context) (inherit (resetClosures reification (car parents)) (cdr parents) reification static) child) (if (valid? (. child __constructor)) (set (quote __label) (. child __constructor name) child)) (valid? (. child __constructor)) (. child __constructor))

EXCEPTION: undefinedVariable
file inherit.lib,line 31: variable . is undefined
